---
title: "index.Rmd"
author: "Lucas Taams"
date: "2023-02-15"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true 
    theme: lumen
    layout: pageWithSidebar
    orientation: rows
---
```{r, test}
library(tidyverse)
library(spotifyr)
library(plotly)
library(compmus)
library(knitr)
library(gridExtra)
library(dplyr)
library(shiny)
library(rmarkdown)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, playlists, echo=FALSE}
old <- get_playlist_audio_features("", "5c80tWKQ1LRPgKqCTEcYKl")
U290s <- get_playlist_audio_features("", "2X6yRUJ8L0fGif3fdAii51")
FirstTime <- get_tidy_audio_analysis("1T6Gh6QOePgmdxpDF1DFx6") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
Mofo <- get_tidy_audio_analysis("6CFk4rAzGaRzoVtjEhcAl9") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
WithWithout <- get_tidy_audio_analysis("5JGEAz15LkPoOtFHttDtVs") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
One <- get_tidy_audio_analysis("3G69vJMWsX6ZohTykad2AU") |> 
  compmus_align(sections, segments) |>                     
  select(sections) |>                                      
  unnest(sections) |>                                      
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "euclidean"              
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "mean", norm = "euclidean"              
      )
  )


```

Introduction
=====================================

**Portfolio for Computational Musicology**

My corpus will consist of several Albums by U2, divided into 2 notable groups: Albums before 1991 (Boy, October, War, The Joshua Tree, Rattle and Hum) and albums in the 90's (Achtung Baby, Zooropa, Pop).

The reason I have chosen for this format is the (quite radical at times) disparity between the genres, stylistic choices and contextual meanings between these periods. After the Joshua Tree (1987) this change already started taking shape, but the culmination started with Achtung Baby (1991). U2 used to be a punk/rock band, But chose to change radically in the 90's, following in the footsteps of the experimental ideas of Producer and Musician Brian Eno. Eno worked with U2 on the Joshua Tree (amongst other things), but employed a much more aetherial, electronic sound in his own works. This, in combination with the rise of 'dance' and electronic music in the 90's, shaped the stylistic choices made by the band throughout the 90's. With these choices they both lost and gained some fans. I am curious to see how these periods compare, and how we can use spotify to dive into this topic.

A typical track for what I would call the 'early' period is "Sunday Bloody Sunday" (Joshua Tree). It is a punkrock song of protest, perfectly fitting the themes and feel of their (previous) albums. A typical track for the late period would be "Zooropa" (Zooropa), and experimental track that is especially adverse when compared to 'Sunday Bloody Sunday'. Now, there aren't many atypical tracks in the early period, but tracks like 'One' (Achtung Baby) and 'Stay (Faraway, so close)' (Zooropa) are very atypical inbetween their work in the 90's. 

It will be very interesting to discover in what ways the Spotify API can provide an insight into the disparity between the 2 periods, as well as a more in-depth review of some of the outlying tracks in both periods, also taking into consideration the significant advancements made in the field of music production in and around the 90's. 

On a sidenote, I would like to inform the reader that even though I have made a valiant attempt to create a visually pleasable and feasible template for this dashboard, my lack (or rather complete absence) of computing and coding experience has made this a frustrating and time-consuming task. I have therefore decided to focus on the content of the portfolio, rather than the visual layout. I apologise in advance if this makes my portfolio unclear in any way. As I said, I have tried my very best... 


Track-level Features
=====================================

Row
------

### U2 pre-90's

```{r, echo=FALSE}

old |> ggplot(aes(x = acousticness, y = energy, text = track.name)) + 
  geom_point() + geom_smooth() + labs(title = "U2 before the 90's", x = "Acousticness", y = "Energy") + theme(aspect.ratio = 1)
ggplotly(tooltip = c("x", "y", "text"))
```

Row
------

### U2 90's
```{r, echo=FALSE}
U290s |> ggplot(aes(x = acousticness, y = energy, text = track.name)) + 
  geom_point() + geom_smooth() + labs(title = "U2 in the 90's", x = "Acousticness", y = "Energy") + theme(aspect.ratio = 1)
 ggplotly(tooltip = c("x", "y", "text"))

```

Sidebar {.sidebar}
-------------------------------------

*Discussion*

The graph on the left shows the relation between energy and acousticness in the songs by U2 from before 1990 and the graph on the right does the same for the 90's period. This showcases that the experimental phase of U2 in the 90's goes hand in hand with a decrease in overall acousticness, whilst maintaining the energy present in their earlier work. The outlier on the bottom right is a song called 'The First Time'. I have chosen to limit these plots to the songs before 2000, as their 2000 album 'All that you can't leave behind' (featuring smash hit 'Beautiful day') meant a return to their style from the 80's after 'POP' (1997), their most dissapointing album in terms of sales and reviews. 

The reason for the return to their old style after the turn of the century has everything to do with the struggles of the band in the 90's, which came from their will to innovate and 'move with the times' (although I think they just had a bit of an identity crisis). Comparing the pre 1990 and post 1990 period in a computational manner will shed a light on the most extensive differences between the two periods, which I will relate to the consequences this had for the band and their music going forward.

Chroma features
=====================================

### First Time
```{r, echo=FALSE}
FirstTime |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### Mofo
```{r, echo=FALSE}
Mofo |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### With or Without you
```{r, echo=FALSE}
WithWithout |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

Sidebar {.sidebar}
-------------------------------------

*Chroma Analysis*

On this page I showcase the chroma features of three different tracks by U2, to delve a bit deeper into the harmonic structure of some of their songs in different periods. I have chosen:

'The First Time' (Key: ), an outlier track from the 90s which displays a combination of low energy and high acousticness that is unusual for their music from that period. It is also quite monotone in its harmonic structure, in contrast to the track 'Mofo' on its right, which is from the same period but radically different. 

'Mofo', produced by synthpop producer Mark Ellis (aka Flood) is an eclectic, high energy song which has an acousticness of near zero (understandably). It is very representative of the artistic turn U2 took in the 90's embracing dance and disco whilst leaving the elements that made them famous in the 80's behind. The use of modulating, distorted synths and the fast tempo of the song atrribute to its energy and acousticness rating, but are also reflected in the chromagram which is a bit all over the place, as it struggles with these effects. 

'With or Without You', one of their most iconic songs from the 'Joshua Tree' Album (1987) which is on the lower end of the energy spectrum in comparison to many of the other tracks and displays a low acousticness according to the Spotify API, even though it doesn't exactly feel that way. Synths, the use of reverb and other forms of FX likely contribute to this. This was quite innovative for the time period and was a consequence of the moving and renovating of windmill lane studios in Dublin. This was done explicitly to accomodate the technology and capacity required for the ambitions U2 had with the Joshua Tree album. 

Interestingly, this song may sound relatively acoustic to our 21st century ears but was not perceived that way per se in 1987 (although the live version was far more acoustic). If the acousticness for this song is near zero, however, I can't help but wonder if it takes the production year/circumstances into account. Otherwise modern pop and EDM would need an even lower value? Alas, I digress. This is something for a different corpus all together.



Loudness and Timbre
=====================================

### One 
```{r, echo=FALSE}
One |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() +
  scale_x_continuous(breaks = c(60, 120, 180, 240))
```

Sidebar {.sidebar}
-------------------------------------

*Loudness and Timbre*

The Cepstogram (or 'Timbregram') on the right showcases the Timbre features of one of U2's most well known songs: 'One' (1991) from the album 'Achtung Baby'. This album showcases the transition between their early work and their experimental phase in the 90's. It also provides the only number 1 hit they score in this period, which ironically is closest to their earlier work as well. 'One' has quite a standard structure: (V-CH-V2-CH2-V3-CH3-B-Ch4-Outtro) but increases in energy exponentially towards the climax where singer Bono exclaims 'Higher! (Baby). This is represented very well in the cepstogram, where timbre feature c01 (loudness) increases in magnitude all the way through to the end.



Temporal features
=====================================

Temporal something

Classification and Clustering
=====================================

Classification something

Discussion/Conclusion
=====================================

Sidebar {.sidebar}
=====================================
